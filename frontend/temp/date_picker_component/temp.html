<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>íœ´ê°€ ê´€ë¦¬ ì‹œìŠ¤í…œ</title>
  <style>
    /* ì „ì²´ í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background-color: #f5f7fb;
      color: #333;
      line-height: 1.6;
      padding: 20px;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    
    .page-title {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 30px;
      color: #2c3e50;
      padding-bottom: 10px;
      border-bottom: 2px solid #e6e9f0;
    }
    
    /* êµ¬ì—­ ê³µí†µ ìŠ¤íƒ€ì¼ */
    .section {
      background-color: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      padding: 20px;
      margin-bottom: 30px;
    }
    
    .section-title {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 20px;
      color: #2c3e50;
      display: flex;
      align-items: center;
    }
    
    .section-title-icon {
      margin-right: 10px;
      color: #3498db;
    }
    
    /* ë¼ë””ì˜¤ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .select-mode {
      display: flex;
      margin-bottom: 15px;
      gap: 20px;
    }
    
    .radio-option {
      display: flex;
      align-items: center;
    }
    
    .radio-option input[type="radio"] {
      margin-right: 8px;
      accent-color: #3498db;
    }
    
    .radio-option label {
      font-size: 14px;
      color: #444;
    }
    
    /* ë‚ ì§œ ì…ë ¥ í•„ë“œ ìŠ¤íƒ€ì¼ - í¬ê¸° ì¡°ì • */
    .date-input-container {
      display: flex;
      align-items: center;
      max-width: 250px;
      margin-bottom: 15px;
    }
    
    .date-input-wrapper {
      position: relative;
      flex: 1;
      height: 36px;
      border: 1px solid #dfe3e9;
      border-radius: 5px;
      overflow: hidden;
      background-color: #fff;
      display: flex;
      align-items: center;
      width: 250px;
    }
    
    .date-input {
      width: 100%;
      padding: 8px 10px;
      font-size: 13px;
      border: none;
      background: transparent;
      cursor: pointer;
    }
    
    .calendar-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 100%;
      cursor: pointer;
      border-left: 1px solid #eaecef;
    }
    
    .calendar-icon svg {
      color: #6c757d;
      width: 16px;
      height: 16px;
    }
    
    /* êµ¬ì—­ B ìŠ¤íƒ€ì¼ */
    .vacation-days-container {
      display: flex;
      align-items: center;
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .vacation-days-input {
      width: 100px;
      padding: 10px;
      border: 1px solid #dfe3e9;
      border-radius: 5px;
      font-size: 14px;
    }
    
    .vacation-days-label {
      font-size: 14px;
      color: #444;
    }
    
    /* êµ¬ì—­ C ìŠ¤íƒ€ì¼ - ë“±ë¡ ì»¨í…Œì´ë„ˆ í¬ê¸° ì¡°ì • */
    .vacation-register-container {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
      max-width: 350px;
    }
    
    .register-date-container {
      flex: 1;
      min-width: 250px;
      max-width: 250px;
    }
    
    .register-button {
      background-color: #3498db;
      color: white;
      border: none;
      border-radius: 5px;
      padding: 7px 18px;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.3s;
      height: 36px;
      min-width: 80px;
    }
    
    .register-button:hover {
      background-color: #2980b9;
    }
    
    /* êµ¬ì—­ D ìŠ¤íƒ€ì¼ */
    .result-container {
      padding: 20px;
      background-color: #f9f9f9;
      border-radius: 5px;
      border: 1px dashed #ddd;
      min-height: 100px; /* ìµœì†Œ ë†’ì´ ì¶”ê°€ */
    }
    
    .result-line {
      margin-bottom: 10px;
      line-height: 1.5;
    }
    
    .result-data {
      color: #2980b9;
      font-weight: 500;
    }
    
    /* ëª¨ë‹¬ ì˜¤ë²„ë ˆì´ ìŠ¤íƒ€ì¼ */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }
    
    .modal-content {
      background-color: #fff;
      border-radius: 10px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      width: 90%;
      max-width: 800px;
    }
    
    /* ë°˜ì‘í˜• ìŠ¤íƒ€ì¼ */
    @media (max-width: 768px) {
      .vacation-register-container {
        flex-direction: column;
        gap: 15px;
        max-width: 100%;
      }
      
      .register-date-container {
        width: 100%;
        max-width: 100%;
      }
      
      .date-input-wrapper {
        width: 100%;
      }
      
      .register-button {
        width: 100%;
      }
    }
  </style>
  
  <!-- Web Component ìŠ¤í¬ë¦½íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸° -->
  <script type="module" src="date_selector_component.js"></script>
</head>
<body>
  <div class="container">
    <h1 class="page-title">íœ´ê°€ ê´€ë¦¬ ì‹œìŠ¤í…œ</h1>
    
    <!-- êµ¬ì—­ A: ì‚¬ìš©ê¸°ê°„ ë²”ìœ„ ì„¤ì • -->
    <div class="section" id="section-a">
      <h2 class="section-title">
        <span class="section-title-icon">ğŸ“…</span>
        ì‚¬ìš©ê¸°ê°„ ë²”ìœ„ ì„¤ì •
      </h2>
      
      <div class="select-mode">
        <div class="radio-option">
          <input type="radio" id="periodMonthOption" name="periodSelectType" value="month">
          <label for="periodMonthOption">ì›”ë³„ ì„ íƒ</label>
        </div>
        <div class="radio-option">
          <input type="radio" id="periodDateOption" name="periodSelectType" value="date" checked>
          <label for="periodDateOption">ë‚ ì§œë³„ ì„ íƒ</label>
        </div>
      </div>
      
      <div class="date-input-container">
        <div class="date-input-wrapper">
          <input type="text" id="periodDateRangePicker" class="date-input" placeholder="ì‚¬ìš©ê¸°ê°„ì„ ì„ íƒí•˜ì„¸ìš”" readonly>
          <label for="periodDateRangePicker" class="calendar-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
              <line x1="16" y1="2" x2="16" y2="6"></line>
              <line x1="8" y1="2" x2="8" y2="6"></line>
              <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
          </label>
        </div>
      </div>
    </div>
    
    <!-- êµ¬ì—­ B: ì‚¬ìš© ê°€ëŠ¥í•œ íœ´ê°€ì¼ìˆ˜ -->
    <div class="section" id="section-b">
      <h2 class="section-title">
        <span class="section-title-icon">ğŸ–ï¸</span>
        ì‚¬ìš© ê°€ëŠ¥í•œ íœ´ê°€ì¼ìˆ˜
      </h2>
      
      <div class="vacation-days-container">
        <label for="vacationDaysInput" class="vacation-days-label">ì´ íœ´ê°€ì¼ìˆ˜:</label>
        <input type="number" id="vacationDaysInput" class="vacation-days-input" value="117" min="0" max="365">
        <span class="vacation-days-label">ì¼</span>
  
        <!-- ìµœëŒ€ ë“±ë¡ íšŸìˆ˜ ì…ë ¥ í•„ë“œ ì¶”ê°€ -->
        <label for="maxRegistrationsInput" class="vacation-days-label" style="margin-left: 20px;">ìµœëŒ€ ë“±ë¡ íšŸìˆ˜:</label>
        <input type="number" id="maxRegistrationsInput" class="vacation-days-input" value="3" min="0" max="100">
        <span class="vacation-days-label">íšŒ</span>
      </div>
    </div>
    
    <!-- êµ¬ì—­ C: íœ´ê°€ ë“±ë¡ -->
    <div class="section" id="section-c">
      <h2 class="section-title">
        <span class="section-title-icon">âœï¸</span>
        íœ´ê°€ ë“±ë¡
      </h2>
      
      <div class="select-mode">
        <div class="radio-option">
          <input type="radio" id="vacationMonthOption" name="vacationSelectType" value="month">
          <label for="vacationMonthOption">ì›”ë³„ ì„ íƒ</label>
        </div>
        <div class="radio-option">
          <input type="radio" id="vacationDateOption" name="vacationSelectType" value="date" checked>
          <label for="vacationDateOption">ë‚ ì§œë³„ ì„ íƒ</label>
        </div>
      </div>
      
      <div class="vacation-register-container">
        <div class="register-date-container">
          <div class="date-input-wrapper">
            <input type="text" id="vacationDateRangePicker" class="date-input" placeholder="íœ´ê°€ê¸°ê°„ì„ ì„ íƒí•˜ì„¸ìš”" readonly>
            <label for="vacationDateRangePicker" class="calendar-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
              </svg>
            </label>
          </div>
        </div>
        <button id="registerVacationBtn" class="register-button">ë“±ë¡í•˜ê¸°</button>
      </div>
    </div>
    
    <!-- êµ¬ì—­ D: ë“±ë¡ ê²°ê³¼ -->
    <div class="section" id="section-d">
      <h2 class="section-title">
        <span class="section-title-icon">ğŸ“Š</span>
        ë“±ë¡ ê²°ê³¼
      </h2>
      
      <div class="result-container">
        <!-- ê¸°ì¡´ ë”ë¯¸ ë‚´ìš© ì œê±° -->
      </div>
    </div>
  </div>
  
  <!-- ëª¨ë‹¬ ì˜¤ë²„ë ˆì´ (ì‚¬ìš©ê¸°ê°„ ë²”ìœ„ ì„¤ì •) -->
  <div id="periodModalOverlay" class="modal-overlay">
    <div class="modal-content">
      <date-selector-component
        id="periodDateSelector"
        width="100%"
        max-width="800px"
      ></date-selector-component>
    </div>
  </div>
  
  <!-- ëª¨ë‹¬ ì˜¤ë²„ë ˆì´ (íœ´ê°€ ë“±ë¡) -->
  <div id="vacationModalOverlay" class="modal-overlay">
    <div class="modal-content">
      <date-selector-component
        id="vacationDateSelector"
        width="100%"
        max-width="800px"
      ></date-selector-component>
    </div>
  </div>
  
  <script>
    // DOM ì°¸ì¡°
    const periodDateRangePicker = document.getElementById('periodDateRangePicker');
    const vacationDateRangePicker = document.getElementById('vacationDateRangePicker');
    const periodModalOverlay = document.getElementById('periodModalOverlay');
    const vacationModalOverlay = document.getElementById('vacationModalOverlay');
    const periodDateSelector = document.getElementById('periodDateSelector');
    const vacationDateSelector = document.getElementById('vacationDateSelector');
    const vacationDaysInput = document.getElementById('vacationDaysInput');
    
    // ë‚ ì§œ ë° ë²”ìœ„ ê´€ë ¨ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
    const dateUtils = {
      // ë¬¸ìì—´ì—ì„œ ë‚ ì§œ ë²”ìœ„ ê°ì²´ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
      getDateRangeFromString(dateRangeString) {
        if (!dateRangeString) return null;
        
        const parts = dateRangeString.split(' ~ ');
        if (parts.length !== 2) return null;
        
        const startParts = parts[0].split('.');
        const endParts = parts[1].split('.');
        
        // ì›”ë³„ ëª¨ë“œ (YYYY.MM)
        if (startParts.length === 2 && endParts.length === 2) {
          const startDate = new Date(parseInt(startParts[0]), parseInt(startParts[1]) - 1, 1);
          const endDate = new Date(parseInt(endParts[0]), parseInt(endParts[1]), 0); // í•´ë‹¹ ì›”ì˜ ë§ˆì§€ë§‰ ë‚ 
          return { startDate, endDate };
        }
        
        // ë‚ ì§œ ëª¨ë“œ (YYYY.MM.DD)
        if (startParts.length === 3 && endParts.length === 3) {
          const startDate = new Date(parseInt(startParts[0]), parseInt(startParts[1]) - 1, parseInt(startParts[2]));
          const endDate = new Date(parseInt(endParts[0]), parseInt(endParts[1]) - 1, parseInt(endParts[2]));
          return { startDate, endDate };
        }
        
        return null;
      },

      // ë‘ ë‚ ì§œ ì‚¬ì´ì˜ ì¼ìˆ˜ ê³„ì‚°
      getDaysBetweenDates(startDate, endDate) {
        if (!startDate || !endDate) return 0;
        
        // ë‚ ì§œë§Œ ë¹„êµí•˜ê¸° ìœ„í•´ ì‹œê°„ì„ ë™ì¼í•˜ê²Œ ì„¤ì •
        const start = new Date(startDate);
        start.setHours(0, 0, 0, 0);
        const end = new Date(endDate);
        end.setHours(0, 0, 0, 0);
        
        // ë°€ë¦¬ì´ˆ ì°¨ì´ë¥¼ ì¼ìˆ˜ë¡œ ë³€í™˜ (í•˜ë£¨ = 24 * 60 * 60 * 1000 ë°€ë¦¬ì´ˆ)
        const diffTime = Math.abs(end - start);
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1; // ì‹œì‘ì¼ê³¼ ì¢…ë£Œì¼ ëª¨ë‘ í¬í•¨
        
        return diffDays;
      }
    };

    // íœ´ê°€ ê´€ë¦¬ ê°ì²´
    const vacationManager = {
      // ì‚¬ìš©ê¸°ê°„ ë²”ìœ„
      periodRange: {
        startDate: null,
        endDate: null
      },
      
      // íœ´ê°€ ì„ íƒ ë²”ìœ„
      vacationRange: {
        startDate: null,
        endDate: null
      },
      
      // A êµ¬ì—­ì˜ ë²”ìœ„ ì„¤ì •
      setPeriodRange(startDate, endDate) {
        this.periodRange.startDate = startDate ? new Date(startDate) : null;
        this.periodRange.endDate = endDate ? new Date(endDate) : null;
        
        // C êµ¬ì—­ ë°ì´í„°ê°€ ì´ë¯¸ ìˆë‹¤ë©´ ë²”ìœ„ ë‚´ë¡œ ì¡°ì •
        this.validateVacationRange();
      },
      
      // C êµ¬ì—­ì˜ íœ´ê°€ ë²”ìœ„ ì„¤ì •
      setVacationRange(startDate, endDate) {
        this.vacationRange.startDate = startDate ? new Date(startDate) : null;
        this.vacationRange.endDate = endDate ? new Date(endDate) : null;

        
        // ë²”ìœ„ ìœ íš¨ì„± ê²€ì‚¬ ë° ì¡°ì •
        this.validateVacationRange();
      },
      
      // íœ´ê°€ ë²”ìœ„ ìœ íš¨ì„± ê²€ì‚¬ ë° ì¡°ì •
      validateVacationRange() {
        if (!this.vacationRange.startDate || !this.vacationRange.endDate) return;
        
        // 1. ì‹œì‘ì¼ì´ ê¸°ê°„ ë²”ìœ„ ë‚´ì— ìˆëŠ”ì§€ í™•ì¸
        if (this.periodRange.startDate && this.vacationRange.startDate < this.periodRange.startDate) {
          this.vacationRange.startDate = new Date(this.periodRange.startDate);
        }
        
        // 2. ì¢…ë£Œì¼ì´ ê¸°ê°„ ë²”ìœ„ë¥¼ ì´ˆê³¼í•˜ì§€ ì•Šë„ë¡ ì¡°ì •
        if (this.periodRange.endDate && this.vacationRange.endDate > this.periodRange.endDate) {
          this.vacationRange.endDate = new Date(this.periodRange.endDate);
        }
        
        // 3. ìµœëŒ€ íœ´ê°€ì¼ìˆ˜ ì œí•œ ì ìš©
        const maxDays = parseInt(vacationDaysInput.value) || 0;
        if (maxDays > 0) {
          const maxEndDate = new Date(this.vacationRange.startDate);
          maxEndDate.setDate(maxEndDate.getDate() + maxDays - 1); // maxDaysì—ëŠ” ì‹œì‘ì¼ë„ í¬í•¨
          
          // ìµœëŒ€ íœ´ê°€ì¼ìˆ˜ì™€ ê¸°ê°„ ì¢…ë£Œì¼ ì¤‘ ë” ì•ì„  ë‚ ì§œë¥¼ ì„ íƒ
          if (this.periodRange.endDate) {
            const limitEndDate = maxEndDate < this.periodRange.endDate ? maxEndDate : this.periodRange.endDate;
            
            if (this.vacationRange.endDate > limitEndDate) {
              this.vacationRange.endDate = new Date(limitEndDate);
            }
          } else if (this.vacationRange.endDate > maxEndDate) {
            this.vacationRange.endDate = new Date(maxEndDate);
          }
        }
      }
    };

    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •

    // ê¸°ê°„ ë²”ìœ„ ëª¨ë‹¬ ê´€ë ¨ ì„¤ì •
    document.querySelector('[for="periodDateRangePicker"]').addEventListener('click', () => {
      const selectedMode = document.querySelector('input[name="periodSelectType"]:checked').value;
      periodDateSelector.setAttribute('select-mode', selectedMode);
      periodModalOverlay.style.display = 'flex';
    });

    // íœ´ê°€ ë“±ë¡ ëª¨ë‹¬ ê´€ë ¨ ì„¤ì •
    document.querySelector('[for="vacationDateRangePicker"]').addEventListener('click', () => { 
      if (!periodDateRangePicker.value) {
        alert('ë¨¼ì € ì‚¬ìš©ê¸°ê°„ ë²”ìœ„ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      const selectedMode = document.querySelector('input[name="vacationSelectType"]:checked').value;
      vacationDateSelector.setAttribute('select-mode', selectedMode);
      
      // ì‚¬ìš©ê¸°ê°„ ë²”ìœ„ ë‚´ì—ì„œë§Œ ì„ íƒ ê°€ëŠ¥í•˜ë„ë¡ ì œí•œ ì„¤ì •
      const periodRange = dateUtils.getDateRangeFromString(periodDateRangePicker.value);
      if (periodRange) {
        // ì´ íœ´ê°€ì¼ìˆ˜ì™€ í˜„ì¬ê¹Œì§€ ì‚¬ìš©í•œ ëˆ„ì  ì¼ìˆ˜
        const totalVacationDays = parseInt(vacationDaysInput.value) || 0;
        const totalUsedDays = window.vacationRegistration?.getTotalUsedDays() || 0;
        const remainingDays = totalVacationDays - totalUsedDays;
        
        // ë‚¨ì€ íœ´ê°€ì¼ìˆ˜ê°€ ì—†ìœ¼ë©´ ì•Œë¦¼ í‘œì‹œ í›„ ì¢…ë£Œ
        if (remainingDays <= 0) {
          alert('ì‚¬ìš© ê°€ëŠ¥í•œ íœ´ê°€ì¼ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤.');
          return;
        }
        
        // ë‚ ì§œ ì„ íƒê¸°ì— ë²”ìœ„ ì„¤ì •
        vacationDateSelector.setSelectableDateRange(
          periodRange.startDate,  // ìµœì†Œ ì„ íƒ ê°€ëŠ¥ ë‚ ì§œ (ì‚¬ìš©ê¸°ê°„ ì‹œì‘ì¼)
          periodRange.endDate     // ìµœëŒ€ ì„ íƒ ê°€ëŠ¥ ë‚ ì§œ (ì‚¬ìš©ê¸°ê°„ ì¢…ë£Œì¼)
        );
    
        // ì´ë¯¸ ë“±ë¡ëœ íœ´ê°€ ê¸°ê°„ì„ ì„ íƒ ë¶ˆê°€ëŠ¥í•œ ê¸°ê°„ìœ¼ë¡œ ì„¤ì •
        const disabledPeriods = window.vacationRegistration.getDisabledPeriods();
        if (disabledPeriods && disabledPeriods.length > 0) {
          vacationDateSelector.setDisabledDateRanges(disabledPeriods);
        }
    
        // ì‹œì‘ì¼ ì´ˆê¸°í™” (ë²”ìœ„ì˜ ì²˜ìŒ ë‚ ì§œë¡œ)
        let initialStartDate = new Date(periodRange.startDate);
        initialStartDate.setHours(0, 0, 0, 0);
    
        // ì‹œì‘ì¼ë¶€í„° ë²”ìœ„ ë‚´ì—ì„œ ì²« ë²ˆì§¸ ì‚¬ìš© ê°€ëŠ¥í•œ ë‚ ì§œ ì°¾ê¸°
        let foundAvailableDate = false;
        const maxIterations = 366; // ë¬´í•œ ë£¨í”„ ë°©ì§€ë¥¼ ìœ„í•œ ìµœëŒ€ ë°˜ë³µ íšŸìˆ˜
        let iterations = 0;
    
        while (!foundAvailableDate && iterations < maxIterations && initialStartDate <= periodRange.endDate) {
          if (!vacationDateSelector.isDateInDisabledRanges(initialStartDate)) {
            foundAvailableDate = true;
          } else {
            initialStartDate.setDate(initialStartDate.getDate() + 1);
          }
          iterations++;
        }
    
        // ì‚¬ìš© ê°€ëŠ¥í•œ ë‚ ì§œê°€ ì—†ëŠ” ê²½ìš° ì²˜ë¦¬
        if (!foundAvailableDate || initialStartDate > periodRange.endDate) {
          alert('ì„ íƒ ê°€ëŠ¥í•œ ë‚ ì§œê°€ ì—†ìŠµë‹ˆë‹¤.');
          return;
        }
        
        // max-days ì†ì„± ì„¤ì • (ì”ì—¬ì¼ìˆ˜ ì‚¬ìš©)
        vacationDateSelector.setAttribute('max-days', remainingDays);
        
        // ì´ˆê¸° ì„ íƒ ì„¤ì • - ì‹œì‘ì¼ê³¼ ì¢…ë£Œì¼ì„ ë™ì¼í•˜ê²Œ ì„¤ì •
        vacationDateSelector.setDateRange(
          initialStartDate,  // ì‹œì‘ì¼ì€ ì°¾ì€ ì²« ì‚¬ìš© ê°€ëŠ¥ ë‚ ì§œ
          initialStartDate,  // ì¢…ë£Œì¼ë„ ì‹œì‘ì¼ê³¼ ë™ì¼í•˜ê²Œ ì„¤ì •
          periodRange.startDate,  // ì„ íƒ ê°€ëŠ¥í•œ ìµœì†Œ ë‚ ì§œ
          periodRange.endDate     // ì„ íƒ ê°€ëŠ¥í•œ ìµœëŒ€ ë‚ ì§œ
        );
      }
      
      vacationModalOverlay.style.display = 'flex';
    });
    

    // ëª¨ë“œ ë³€ê²½ ì‹œ ì´ë²¤íŠ¸
    document.querySelectorAll('input[name="periodSelectType"]').forEach(radio => {
      radio.addEventListener('change', () => {
        periodDateRangePicker.value = '';
        // ê¸°ê°„ ë²”ìœ„ê°€ ë³€ê²½ë˜ë©´ íœ´ê°€ ì„¤ì •ë„ ì´ˆê¸°í™”
        vacationDateRangePicker.value = '';
        vacationManager.periodRange.startDate = null;
        vacationManager.periodRange.endDate = null;
        vacationManager.vacationRange.startDate = null;
        vacationManager.vacationRange.endDate = null;
      });
    });

    document.querySelectorAll('input[name="vacationSelectType"]').forEach(radio => {
      radio.addEventListener('change', () => {
        vacationDateRangePicker.value = '';
        vacationManager.vacationRange.startDate = null;
        vacationManager.vacationRange.endDate = null;
      });
    });

    // ì›¹ ì»´í¬ë„ŒíŠ¸ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
    periodDateSelector.addEventListener('close-picker', () => {
      periodModalOverlay.style.display = 'none';
    });

    periodDateSelector.addEventListener('confirm-dates', (e) => {
      periodDateRangePicker.value = e.detail.formattedText;
      periodModalOverlay.style.display = 'none';
      
      // ì‚¬ìš©ê¸°ê°„ ë²”ìœ„ ì„¤ì •
      vacationManager.setPeriodRange(e.detail.startDate, e.detail.endDate);
      
      // C êµ¬ì—­ì˜ íœ´ê°€ ê¸°ê°„ë„ ì´ˆê¸°í™” (ë²”ìœ„ê°€ ë³€ê²½ë˜ì—ˆìœ¼ë¯€ë¡œ)
      vacationDateRangePicker.value = '';
      vacationManager.vacationRange.startDate = null;
      vacationManager.vacationRange.endDate = null;
    });

    vacationDateSelector.addEventListener('close-picker', () => {
      vacationModalOverlay.style.display = 'none';
    });

    vacationDateSelector.addEventListener('confirm-dates', (e) => {
      vacationDateRangePicker.value = e.detail.formattedText;
      vacationModalOverlay.style.display = 'none';
      
      // íœ´ê°€ ë²”ìœ„ ì„¤ì •
      vacationManager.setVacationRange(e.detail.startDate, e.detail.endDate);
    });

    // íœ´ê°€ì¼ìˆ˜ ë³€ê²½ ì‹œ ì´ë²¤íŠ¸
    vacationDaysInput.addEventListener('change', () => {
      // ì´ë¯¸ íœ´ê°€ ë²”ìœ„ê°€ ì„¤ì •ë˜ì–´ ìˆëŠ” ê²½ìš°, íœ´ê°€ì¼ìˆ˜ ë³€ê²½ì— ë”°ë¼ ì¡°ì •
      if (vacationManager.vacationRange.startDate && vacationManager.vacationRange.endDate) {
        vacationManager.validateVacationRange();
        
        // ì¡°ì • í›„ ë‚ ì§œë¥¼ í‘œì‹œ í˜•ì‹ìœ¼ë¡œ ë³€í™˜
        if (vacationManager.vacationRange.startDate && vacationManager.vacationRange.endDate) {
          const formatDate = (date, isMonth = false) => {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            if (isMonth) return `${year}.${month}`;
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}.${month}.${day}`;
          };
          
          const selectedMode = document.querySelector('input[name="vacationSelectType"]:checked').value;
          const isMonthMode = selectedMode === 'month';
          
          const startStr = formatDate(vacationManager.vacationRange.startDate, isMonthMode);
          const endStr = formatDate(vacationManager.vacationRange.endDate, isMonthMode);
          
          vacationDateRangePicker.value = `${startStr} ~ ${endStr}`;
        }
      }
    });

    // ì´ˆê¸°í™” í•¨ìˆ˜
    function initVacationSystem() {
      // í˜„ì¬ ë‚ ì§œ ê¸°ì¤€ìœ¼ë¡œ ì´ˆê¸° ì‚¬ìš©ê¸°ê°„ ì„¤ì • (ì˜ˆ: í˜„ì¬ ì›”)
      const today = new Date();
      const currentYear = today.getFullYear();
      const currentMonth = today.getMonth();
      
      // ì´ˆê¸° ì´ íœ´ê°€ì¼ìˆ˜ ì„¤ì •
      vacationDaysInput.value = '117';
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
    document.addEventListener('DOMContentLoaded', initVacationSystem);
  </script>
  <script src="vacation_registration.js"></script>
</body>
</html>